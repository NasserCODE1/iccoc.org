import{b as F,c as $,d as U,e as R,g as N,l as q}from"./chunk-5VOQWTQD.js";import{Ab as _,Bb as f,Da as E,Ea as P,Gb as c,Ha as n,Hb as s,Jb as A,Kb as k,Ma as b,Sa as H,Wa as v,Y as m,Z as u,_b as j,bc as V,cc as z,ec as L,fc as D,gb as T,hb as h,ib as l,jb as o,kb as B,lc as W,mc as Y,nb as w,nc as G,ob as S,pb as O,qb as x,rb as g,wb as I,xb as K,zb as d}from"./chunk-HKFESCHS.js";function Z(a,e){if(a&1){let t=O();l(0,"button",11),x("click",function(){m(t);let r=g();return u(r.goBack())}),d(1),c(2,"translate"),o()}a&2&&(n(),f(" \u2190 ",s(2,1,"media.back")," "))}function tt(a,e){if(a&1){let t=O();l(0,"div",13)(1,"div",14)(2,"div",15)(3,"img",16),c(4,"translate"),x("error",function(r){m(t);let p=g(2);return u(p.onImgError(r))}),o()(),l(5,"div",17)(6,"h2",18),d(7),c(8,"translate"),o(),l(9,"p",19),d(10),c(11,"translate"),o(),B(12,"div",20),l(13,"div",21)(14,"button",22),x("click",function(){m(t);let r=g(2);return u(r.goSubscribe())}),d(15),c(16,"translate"),o(),l(17,"a",23),x("click",function(r){let p=m(t).ngIf;return g(2).openExternal(p),u(r.preventDefault())}),d(18),c(19,"translate"),o()()()()()}if(a&2){let t=e.ngIf,i=g(2);n(3),h("src",t.img,P)("alt",s(4,7,t.titleKey)),n(4),_(s(8,9,t.titleKey)),n(3),_(s(11,11,t.titleKey)),n(2),h("innerHTML",i.currentArticleHtml,E),n(3),f(" ",s(16,13,"media.subscribe")," "),n(3),f(" ",s(19,15,"media.read_more")," ")}}function et(a,e){a&1&&(l(0,"div",24),d(1),c(2,"translate"),o()),a&2&&(n(),f(" ",s(2,1,"media.not_found")," "))}function it(a,e){if(a&1&&(w(0),v(1,tt,20,17,"div",12)(2,et,3,3,"ng-template",null,1,k),S()),a&2){let t=I(3),i=g();n(),h("ngIf",i.selectedArticle)("ngIfElse",t)}}function nt(a,e){if(a&1){let t=O();w(0),l(1,"article",28)(2,"div",15)(3,"img",16),c(4,"translate"),x("error",function(r){m(t);let p=g(2);return u(p.onImgError(r))}),o()(),l(5,"div",17)(6,"h3",18),d(7),c(8,"translate"),o(),l(9,"p",29),d(10),c(11,"translate"),c(12,"slice"),o(),l(13,"div",30)(14,"a",31),x("click",function(r){let p=m(t).$implicit;return g(2).openExternal(p),u(r.preventDefault())}),d(15),c(16,"translate"),o(),l(17,"button",11),x("click",function(){m(t);let r=g(2);return u(r.goSubscribe())}),d(18),c(19,"translate"),o()()()(),S()}if(a&2){let t=e.$implicit;n(3),h("src",t.img,P)("alt",s(4,6,t.titleKey)),n(4),_(s(8,8,t.titleKey)),n(3),f(" ",A(12,12,t.bodyKey?s(11,10,t.bodyKey):"",0,160),"... "),n(5),f(" ",s(16,16,"media.read_more")," "),n(3),f(" ",s(19,18,"media.subscribe")," ")}}function rt(a,e){if(a&1&&(l(0,"div",25)(1,"h2"),d(2),c(3,"translate"),o(),l(4,"p",7),d(5),c(6,"translate"),o()(),l(7,"div",26),v(8,nt,20,20,"ng-container",27),o()),a&2){let t=g();n(2),_(s(3,3,"media.recent")),n(3),_(s(6,5,"media.subscribe_desc")),n(3),h("ngForOf",t.articles)}}var J=class a{constructor(e,t,i,r,p,y){this.route=e;this.router=t;this.i18n=i;this.loc=r;this.http=p;this.sanitizer=y}heroBg="assets/img/hero-media.jpg";placeholder="assets/placeholder.jpg";currentLang="en";currentDir="ltr";activeSlug=null;currentArticleHtml=null;routeSub;langSub;articles=[{slug:"mali",img:"assets/media/mali.png",titleKey:"articles.mali.title",bodyKey:"articles.mali.body",externalUrl:"/assets/external/mali.html"},{slug:"haftar",img:"assets/media/haftar.png",titleKey:"articles.haftar.title",bodyKey:"articles.haftar.body",externalUrl:"/assets/external/haftar.html"},{slug:"morocco",img:"assets/media/morocco.png",titleKey:"articles.morocco.title",bodyKey:"articles.morocco.body",externalUrl:"/assets/external/morocco.html"},{slug:"europe",img:"assets/media/europe.png",titleKey:"articles.europe.title",bodyKey:"articles.europe.body",externalUrl:"/assets/external/europe.html"},{slug:"smuggling",img:"assets/media/smuggling.png",titleKey:"articles.smuggling.title",bodyKey:"articles.smuggling.body",externalUrl:"/assets/external/smuggling.html"},{slug:"sudan",img:"assets/media/sudan.png",titleKey:"articles.sudan.title",bodyKey:"articles.sudan.body",externalUrl:"/assets/external/sudan.html"}];ngOnInit(){this.currentLang=this.i18n.currentLang||this.i18n.getDefaultLang?.()||"en",this.currentDir=["ar","he","fa","ur"].includes(this.currentLang.split("-")[0])?"rtl":"ltr",this.routeSub=this.route.paramMap.subscribe(e=>{this.activeSlug=e.get("slug"),this.activeSlug?this.loadContentForSlug(this.activeSlug):this.currentArticleHtml=null}),this.langSub=this.i18n.onLangChange.subscribe(e=>{this.currentLang=e?.lang||this.i18n.currentLang||"en",this.currentDir=["ar","he","fa","ur"].includes(this.currentLang.split("-")[0])?"rtl":"ltr",this.activeSlug&&this.loadContentForSlug(this.activeSlug)})}ngOnDestroy(){this.routeSub?.unsubscribe(),this.langSub?.unsubscribe()}findArticle(e){return e&&this.articles.find(t=>t.slug===e)||null}get selectedArticle(){return this.findArticle(this.activeSlug||void 0)}getBodyFromI18n(e){if(!e)return"";if(e.bodyKey){let i=this.i18n.instant(e.bodyKey);if(i&&i!==e.bodyKey)return i}let t=this.currentLang.split("-")[0];return e?.fallback&&(e.fallback[t]||e.fallback.en)||""}loadContentForSlug(e){let t=this.findArticle(e),r=[`/assets/external/${this.currentLang.split("-")[0]}/${e}.html`,`/assets/external/${e}.html`],p=y=>{if(!y.length){if(t?.externalUrl){if(/^https?:\/\//.test(t.externalUrl)){let M=this.getBodyFromI18n(t);this.currentArticleHtml=this.sanitizer.bypassSecurityTrustHtml(this.wrapBodyHtml(t,M));return}if(t.externalUrl.startsWith("/assets")){this.http.get(t.externalUrl,{responseType:"text"}).subscribe(M=>this.currentArticleHtml=this.sanitizer.bypassSecurityTrustHtml(M),M=>{let X=this.getBodyFromI18n(t);this.currentArticleHtml=this.sanitizer.bypassSecurityTrustHtml(this.wrapBodyHtml(t,X))});return}}let C=this.getBodyFromI18n(t);this.currentArticleHtml=this.sanitizer.bypassSecurityTrustHtml(this.wrapBodyHtml(t,C));return}let Q=y.shift();this.http.get(Q,{responseType:"text"}).subscribe(C=>{this.currentArticleHtml=this.sanitizer.bypassSecurityTrustHtml(C)},C=>{p(y)})};p([...r])}wrapBodyHtml(e,t){let i=e?this.i18n.instant(e.titleKey):"",r=e?`/${e.img}`.replace(/^\/+/,"/"):"";return`
      <div class="media-article">
        <h1 style="font-weight:800;margin-bottom:8px">${this.escapeHtml(i)}</h1>
        ${r?`<img src="${this.escapeHtml(r)}" alt="${this.escapeHtml(i)}" style="max-width:100%;height:auto;border-radius:8px;margin:12px 0" onerror="this.src='${this.placeholder}'"/>`:""}
        <div class="article-body" style="line-height:1.8;color:#233;">
          ${this.escapeNewlinesToParagraphs(t)}
        </div>
      </div>`}escapeNewlinesToParagraphs(e){return e?e.split(/\r?\n/).map(i=>i.trim()).filter(i=>i.length>0).map(i=>`<p>${this.escapeHtml(i)}</p>`).join(`
`):""}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}onImgError(e){let t=e.target;t&&(t.src=this.placeholder)}goBack(){this.activeSlug?this.router.navigate(["/media"]):this.loc.back()}goSubscribe(){this.router.navigate(["/reports"])}openArticle(e){this.router.navigate(["/media",e])}openExternal(e){let i=`/assets/external/${this.currentLang.split("-")[0]}/${e.slug}.html`;window.open(i,"_blank")}static \u0275fac=function(t){return new(t||a)(b(R),b(N),b(W),b(j),b(F),b(U))};static \u0275cmp=H({type:a,selectors:[["app-media"]],decls:15,vars:12,consts:[["listView",""],["notFound",""],[1,"section","media-section"],[1,"container"],[1,"hero"],[1,"wrap","card","soft"],[1,"page-title"],[1,"muted"],[1,"actions-top"],["class","btn",3,"click",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"btn",3,"click"],["class","article-card card soft",4,"ngIf","ngIfElse"],[1,"article-card","card","soft"],[1,"article-layout"],[1,"thumb"],[3,"error","src","alt"],[1,"body"],[1,"title"],[1,"muted","excerpt"],[1,"content",3,"innerHTML"],[1,"article-actions"],[1,"btn","primary",3,"click"],["href","#",1,"btn",3,"click"],[1,"card","soft","not-found-card"],[1,"list-header"],[1,"grid","cols-3","media-grid"],[4,"ngFor","ngForOf"],[1,"card","media-card"],[1,"excerpt"],[1,"actions"],["href","#",1,"btn","primary",3,"click"]],template:function(t,i){if(t&1&&(l(0,"section",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"h1",6),d(5),c(6,"translate"),o(),l(7,"p",7),d(8),c(9,"translate"),o()()(),l(10,"div",8),v(11,Z,3,3,"button",9),o(),v(12,it,4,2,"ng-container",10)(13,rt,9,7,"ng-template",null,0,k),o()()),t&2){let r=I(14);T("dir",i.currentDir),n(2),K("background-image","url("+i.heroBg+")"),n(3),_(s(6,8,"media.title")),n(3),_(s(9,10,"media.welcome")),n(3),h("ngIf",i.activeSlug),n(),h("ngIf",i.activeSlug)("ngIfElse",r)}},dependencies:[D,V,z,q,G,$,L,Y],styles:['@charset "UTF-8";[_ngcontent-%COMP%]:root{--thumb-height-sm: 160px;--thumb-height-md: 220px;--thumb-height-lg: 260px;--card-min-h: 360px;--card-radius: 12px;--card-border: rgba(11,34,64,.06);--card-shadow: 0 12px 30px rgba(10,30,60,.06);--card-shadow-hover: 0 22px 60px rgba(10,30,60,.1)}.media-section[_ngcontent-%COMP%]{padding:42px 0}.media-section[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:35px}.media-section[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{max-width:1180px;margin:0 auto;padding:18px}.hero[_ngcontent-%COMP%]{min-height:36vh;display:grid;place-items:center;position:relative;border-radius:var(--card-radius);background-size:cover;background-position:center;overflow:hidden}.hero[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:linear-gradient(180deg,#03254299,#0325424d)}.hero[_ngcontent-%COMP%]   .wrap[_ngcontent-%COMP%]{position:relative;z-index:1;text-align:center;color:#000}.actions-top[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.grid.cols-3[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}@media (max-width: 980px){.grid.cols-3[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 640px){.grid.cols-3[_ngcontent-%COMP%]{grid-template-columns:1fr}}.media-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-radius:var(--card-radius);overflow:hidden;background:#fff;border:1px solid var(--card-border);min-height:var(--card-min-h);transition:transform .18s ease,box-shadow .18s ease}.media-card[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]{position:relative;width:100%;aspect-ratio:16/9;min-height:var(--thumb-height-md);overflow:hidden;background-color:#0b2240;display:flex;align-items:center;justify-content:center;padding:8px;box-sizing:border-box}.media-card[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:100%;width:auto;height:auto;object-fit:contain;object-position:center;display:block;border-radius:8px;background-color:#ffffff05}.media-card[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:linear-gradient(0deg,#00000005,#00000003);pointer-events:none}.media-card[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{padding:16px;display:flex;flex-direction:column;gap:12px;background:linear-gradient(180deg,#fff,#f7fbff);flex:1}.media-card[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin:0;font-size:1.05rem;font-weight:800;color:#0b2240;text-align:center}.media-card[_ngcontent-%COMP%]   .excerpt[_ngcontent-%COMP%]{margin:0;color:#475569;line-height:1.6;flex:1;text-align:justify}.media-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:12px;align-items:center;justify-content:flex-end}.media-card[_ngcontent-%COMP%]:hover{transform:translateY(-6px);box-shadow:var(--card-shadow-hover)}.btn[_ngcontent-%COMP%]{padding:8px 12px;border-radius:10px;border:0;cursor:pointer;background:#e6eef9;color:#0b2240;font-weight:700}.btn.primary[_ngcontent-%COMP%]{background:#0b5ed7;color:#fff;box-shadow:0 10px 20px #0b5ed71f}.article-card[_ngcontent-%COMP%]{background:linear-gradient(180deg,#fff,#f3f7fb);padding:0;border-radius:var(--card-radius);overflow:hidden}.article-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:45% 55%;gap:16px;align-items:flex-start}.article-layout[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]{min-height:320px;display:flex;align-items:center;justify-content:center;background:#0b2240;padding:12px;box-sizing:border-box;aspect-ratio:4/3}.article-layout[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:100%;width:auto;height:auto;object-fit:contain;object-position:center;display:block;border-radius:12px}.article-layout[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{padding:28px;display:flex;flex-direction:column;gap:18px;color:#0b2240}.article-layout[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.6rem;font-weight:900;margin:0 0 6px;color:#05223a;text-align:right}.article-layout[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{color:#334155;line-height:1.75;white-space:pre-wrap;text-align:justify}.article-actions[_ngcontent-%COMP%]{margin-top:18px;display:flex;gap:8px;align-items:center}.not-found-card[_ngcontent-%COMP%]{text-align:center}.subscribe-block[_ngcontent-%COMP%]{margin-top:26px;display:flex;justify-content:center}.subscribe-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;text-align:center;width:100%;max-width:720px;box-shadow:0 10px 30px #0823460f}.subscribe-actions[_ngcontent-%COMP%]{margin-top:12px;display:flex;gap:8px;justify-content:center;align-items:center}.subscribe-input[_ngcontent-%COMP%]{padding:10px 12px;border-radius:8px;border:1px solid #dbe7f7;width:60%;max-width:360px}@media (max-width: 980px){.media-card[_ngcontent-%COMP%]{min-height:auto}.media-card[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]{min-height:var(--thumb-height-sm);aspect-ratio:16/9}.article-layout[_ngcontent-%COMP%]{grid-template-columns:1fr}.article-layout[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]{min-height:220px;aspect-ratio:16/9}}@media (min-width: 1200px){.media-card[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]{min-height:var(--thumb-height-lg)}}@media print{.hero[_ngcontent-%COMP%]:after{display:none}.media-card[_ngcontent-%COMP%], .article-card[_ngcontent-%COMP%]{box-shadow:none;border:none}}']})};export{J as Media};
